# 开发者工具

Avalonia内置了一个DevTools窗口，可以通过在`Window`构造函数中调用附加的`AttachDevTools()`方法来启用它。默认的模板在以`DEBUG`模式编译程序时会启用该功能：

```csharp
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
    }
}

// in auto-generated by Avalonia.NameGenerator MainWindow.g.cs:
partial class MainWindow
{
    // ...
    public void InitializeComponent(bool loadXaml = true, bool attachDevTools = true)
    {
        // ...
#if DEBUG
        if (attachDevTools)
        {
            this.AttachDevTools();
        }
#endif
        // ...
    }
}
```

要打开 DevTools，请按 F12，或将不同的 `Gesture` 传递给 `this.AttachDevTools()` 方法。

{% hint style="info" %}
从 0.10 版本开始使用 DevTools，你必须添加`Avalonia.Diagnostics`nuget 包。

```bash
dotnet add package Avalonia.Diagnostics --version 0.10.0
```
{% endhint %}

[在.NET](http://xn--3ds.net) core 2.1下运行时，有一个已知的问题，按F12会导致程序退出。在这种情况下，[要么切换到.NET](http://xn--6iq24gsdp74ecs7b.net) core 2.0或3.0+，要么将打开手势更改为其他手势，例如`Ctrl+F12`。

## 逻辑树和视觉树

`Logical Tree` `逻辑树`和 `Visual Tree视觉树`选项卡显示窗口中的控件在逻辑树和视觉树中的位置。选择一个控件将在右侧窗格中显示该控件的属性，可以进行编辑。

### 属性

允许快速检查和编辑控件的属性。可以通过名称或使用正则表达式搜索属性。

| 列        | 描述     |
| -------- | ------ |
| Property | 属性名称   |
| Value    | 属性的当前值 |
| Type     | 当前值的类型 |
| Priority | 值的优先级  |

### 布局

允许检查和编辑通用布局属性 ( `Margin`, `Border`, `Padding`)。 还显示了控件大小和大小限制。

{% hint style="info" %}
如果`Width`或`Height`带有下划线，则表示存在活动约束。将鼠标悬停在值上可查看包含相关信息的工具提示。
{% endhint %}

### 样式

虽然属性面板显示了当前活动属性的值，但样式面板显示了所有值及其来源。

此外，可以通过切换“显示非活动项”选项来查看可能与此控件匹配的所有样式。

可以通过单击“快照”按钮或在悬停在目标窗口上时按下“Alt+S”来快速查看当前样式。快照意味着样式面板不会更新以反映控件的新状态。这在解决`:pointerover`或`:pressed`选择器的问题时特别有用。

{% hint style="info" %}
如果 setter 值绑定到资源，它将由一个圆圈后跟资源键表示。
{% endhint %}

{% hint style="info" %}
如果给定值有删除线，则表示它正在被具有更高优先级的样式值覆盖。
{% endhint %}

设置器有一个上下文菜单，允许快速将名称和值复制到剪贴板。

## 事件

事件选项卡可用于跟踪[事件](broken-reference)的传播。在左窗格中选择要跟踪的事件，该类型的所有事件将显示在中央上窗格中。选择这些事件之一以查看事件路线。

{% hint style="info" %}
事件名称或控件类型下的虚线下划线表示可以进行快速导航。

* 双击一个事件类型将选择并滚动到给定的事件类型
* 双击控件类型（和/或名称）将导航到可视化树选项卡并选择所述控件。
{% endhint %}

## 控制台

控制台可以通过“View”→“Console”菜单显示。控制台实现了一个C# REPL，可以用来运行任意C#代码。在控制台会话中，以下预定义变量可用：

* `help`: 显示帮助信息
* `e`: 当前在逻辑树或可视树中选择的控件
* `root`: 可视化树的根

## 热键

| 组合键        | 功能       |
| ---------- | -------- |
| Alt+S      | 启用快照样式   |
| Alt+D      | 禁用快照样式   |
| CTRL+Shift | 检查对指针的控制 |
| CTRL+Alt+F | 切换弹出窗口冻结 |

## 例子

### 更改属性值

### 更改布局属性
